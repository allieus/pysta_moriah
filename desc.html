<!DOCTYPE html><html lang="ko"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><script type="text/javascript" src="http://wc1.moriah.pe.kr/sh/scripts/shCore.js"></script><script type="text/javascript" src="http://wc1.moriah.pe.kr/sh/scripts/shBrushPython.js"></script><script type="text/javascript" src="http://wc1.moriah.pe.kr/sh/scripts/shBrushJScript.js"></script><link href="http://wc1.moriah.pe.kr/sh/styles/shCore.css" rel="stylesheet" type="text/css" /><link href="http://wc1.moriah.pe.kr/sh/styles/shThemeDjango.css" rel="stylesheet" type="text/css" /><div height="10" style="line-height: 1;padding:2px;spacing:2px;margin:0 0 0 10px;"><br><font style="font-size:14pt"><b> 실습 5. 글 배송에 celery 적용하기</b></font></div><div height="10" style="line-height: 1;padding:2px;spacing:2px;margin:0 0 0 20px;"><br><font style="font-size:12pt">실습 4를 참고하여, 글 쓸때/ 친구가 될 때 / 친구에서 제거 될 때 모두 celery 를 적용합니다.</font></div><div height="10" style="line-height: 1;padding:2px;spacing:2px;margin:0 0 0 20px;"><br><font style="font-size:12pt">&nbsp;</font></div><div height="10" style="line-height: 1;padding:2px;spacing:2px;margin:0 0 0 20px;"><br><font style="font-size:12pt"><b> step 1. timeline/tasks.py 만들고 글 쓸때 follower 에게 글을 보낼 task 만들기</b></font></div><div height="10" style="line-height: 1;padding:2px;spacing:2px;margin:0 0 0 30px;"><br><font style="font-size:11pt">from celery import shared_task</font></div><div height="10" style="line-height: 1;padding:2px;spacing:2px;margin:0 0 0 30px;"><br><font style="font-size:11pt">&nbsp;</font></div><div height="10" style="line-height: 1;padding:2px;spacing:2px;margin:0 0 0 30px;"><br><font style="font-size:11pt">@shared_task</font></div><div height="10" style="line-height: 1;padding:2px;spacing:2px;margin:0 0 0 30px;"><br><font style="font-size:11pt">def distribute</font></div><div height="10" style="line-height: 1;padding:2px;spacing:2px;margin:0 0 0 30px;"><br><font style="font-size:11pt">for follower in 내 팔로워:</font></div><div height="10" style="line-height: 1;padding:2px;spacing:2px;margin:0 0 0 30px;"><br><font style="font-size:11pt">post….add(follower):</font></div><div height="10" style="line-height: 1;padding:2px;spacing:2px;margin:0 0 0 30px;"><br><font style="font-size:11pt">&nbsp;</font></div><div height="10" style="line-height: 1;padding:2px;spacing:2px;margin:0 0 0 30px;"><br><font style="font-size:11pt"><a href="#" onclick="openFile('/timeline/tasks.py');return false;"><img src="/shortcut.png" width="15"/><font color="#0000ff">/timeline/tasks.py</font></a><a href="#" onclick="openFile_ln('/timeline/tasks.py', 8,16);return false;"><font color="#ff0000"> 8:16</font></a></font></div><div height="10" style="line-height: 1;padding:2px;spacing:2px;margin:0 0 0 30px;"><br><font style="font-size:11pt">&nbsp;</font></div><div height="10" style="line-height: 1;padding:2px;spacing:2px;margin:0 0 0 20px;"><br><font style="font-size:12pt"><b> step 2. 글 쓴 후 follower 에게 글을 보내는 부분을 삭제하고, timeline/tasks.py 의 distribute 를 호출하는 것으로 변경</b></font></div><div height="10" style="line-height: 1;padding:2px;spacing:2px;margin:0 0 0 30px;"><br><font style="font-size:11pt"><a href="#" onclick="openFile('/timeline/views.py');return false;"><img src="/shortcut.png" width="15"/><font color="#0000ff">/timeline/views.py</font></a><a href="#" onclick="openFile_ln('/timeline/views.py', 243,243);return false;"><font color="#ff0000"> 243:243</font></a></font></div><div height="10" style="line-height: 1;padding:2px;spacing:2px;margin:0 0 0 30px;"><br><font style="font-size:11pt">&nbsp;</font></div><div height="10" style="line-height: 1;padding:2px;spacing:2px;margin:0 0 0 20px;"><br><font style="font-size:12pt"><b> step 3. 글을 써 보고, 배송이 잘 되는지 확인</b></font></div><div height="10" style="line-height: 1;padding:2px;spacing:2px;margin:0 0 0 30px;"><br><font style="font-size:11pt">&nbsp;</font></div><div height="10" style="line-height: 1;padding:2px;spacing:2px;margin:0 0 0 20px;"><br><font style="font-size:12pt"><b> step 4. 위 step 1~3 을 참고하여 친구 맺을때/친구 제거될 때 모두 비동기 처리로 바꾸어 보기</b></font></div><div height="10" style="line-height: 1;padding:2px;spacing:2px;margin:0 0 0 30px;"><br><font style="font-size:11pt">&nbsp;</font></div><div height="10" style="line-height: 1;padding:2px;spacing:2px;margin:0 0 0 20px;"><br><font style="font-size:12pt"><b> 친구 맺기</b></font></div><div height="10" style="line-height: 1;padding:2px;spacing:2px;margin:0 0 0 30px;"><br><font style="font-size:11pt"><a href="#" onclick="openFile('/timeline/tasks.py');return false;"><img src="/shortcut.png" width="15"/><font color="#0000ff">/timeline/tasks.py</font></a><a href="#" onclick="openFile_ln('/timeline/tasks.py', 19,23);return false;"><font color="#ff0000"> 19:23</font></a></font></div><div height="10" style="line-height: 1;padding:2px;spacing:2px;margin:0 0 0 30px;"><br><font style="font-size:11pt"><a href="#" onclick="openFile('/timeline/views.py');return false;"><img src="/shortcut.png" width="15"/><font color="#0000ff">/timeline/views.py</font></a><a href="#" onclick="openFile_ln('/timeline/views.py', 261,261);return false;"><font color="#ff0000"> 261:261</font></a></font></div><div height="10" style="line-height: 1;padding:2px;spacing:2px;margin:0 0 0 30px;"><br><font style="font-size:11pt">&nbsp;</font></div><div height="10" style="line-height: 1;padding:2px;spacing:2px;margin:0 0 0 20px;"><br><font style="font-size:12pt"><b> 친구 제거</b></font></div><div height="10" style="line-height: 1;padding:2px;spacing:2px;margin:0 0 0 30px;"><br><font style="font-size:11pt"><a href="#" onclick="openFile('/timeline/tasks.py');return false;"><img src="/shortcut.png" width="15"/><font color="#0000ff">/timeline/tasks.py</font></a><a href="#" onclick="openFile_ln('/timeline/tasks.py', 26,32);return false;"><font color="#ff0000"> 26:32</font></a></font></div><div height="10" style="line-height: 1;padding:2px;spacing:2px;margin:0 0 0 30px;"><br><font style="font-size:11pt"><a href="#" onclick="openFile('/timeline/views.py');return false;"><img src="/shortcut.png" width="15"/><font color="#0000ff">/timeline/views.py</font></a><a href="#" onclick="openFile_ln('/timeline/views.py', 277,377);return false;"><font color="#ff0000"> 277:377</font></a></font></div><div height="10" style="line-height: 1;padding:2px;spacing:2px;margin:0 0 0 30px;"><br><font style="font-size:11pt">&nbsp;</font></div><style type='text/css'>
.syntaxhighlighter table tbody
{
 font-size: 12pt !important;
}
</style>

